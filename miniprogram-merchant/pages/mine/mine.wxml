<view class="container">
  <view class="user-header" bindtap="editRiderInfo">
    <image class="avatar" src="{{riderInfo.avatar}}" mode="aspectFill" wx:if="{{riderInfo.avatar}}"></image>
    <view class="avatar-placeholder" wx:if="{{!riderInfo.avatar}}">ğŸ‘¤</view>
    <view class="user-info">
      <text class="user-name">{{riderInfo.maskedName || 'æœªè®¾ç½®'}}</text>
      <text class="user-phone">{{riderInfo.maskedPhone || 'æœªè®¾ç½®'}}</text>
    </view>
  </view>

  <view class="stats-container">
    <view class="stat-card">
      <view class="stat-value">{{stats.pendingCount}}</view>
      <view class="stat-label">å¾…æ¥å•</view>
    </view>
    <view class="stat-card">
      <view class="stat-value">{{stats.processingCount}}</view>
      <view class="stat-label">å¤„ç†ä¸­</view>
    </view>
    <view class="stat-card">
      <view class="stat-value">{{stats.completedCount}}</view>
      <view class="stat-label">å·²å®Œæˆ</view>
    </view>
    <view class="stat-card">
      <view class="stat-value">Â¥{{stats.todayAmount}}</view>
      <view class="stat-label">ä»Šæ—¥è¥ä¸šé¢</view>
    </view>
  </view>

  <view class="filter-tabs">
    <view 
      class="tab-item {{currentStatus === 0 ? 'active' : ''}}" 
      bindtap="filterOrders"
      data-status="0"
    >å…¨éƒ¨</view>
    <view 
      class="tab-item {{currentStatus === 1 ? 'active' : ''}}" 
      bindtap="filterOrders"
      data-status="1"
    >å¾…æ¥å•</view>
    <view 
      class="tab-item {{currentStatus === 2 ? 'active' : ''}}" 
      bindtap="filterOrders"
      data-status="2"
    >å¾…å‡ºé¤</view>
    <view 
      class="tab-item {{currentStatus === 3 ? 'active' : ''}}" 
      bindtap="filterOrders"
      data-status="3"
    >å¾…é…é€</view>
    <view 
      class="tab-item {{currentStatus === 4 ? 'active' : ''}}" 
      bindtap="filterOrders"
      data-status="4"
    >é…é€ä¸­</view>
  </view>

  <view class="order-list">
    <view 
      class="order-item" 
      wx:for="{{orders}}" 
      wx:key="id"
      bindtap="goToDetail"
      data-id="{{item.id}}"
    >
      <view class="order-header">
        <view class="order-no">{{item.orderNo}}</view>
        <view class="order-status {{getStatusClass(item.status)}}">{{getStatusText(item.status)}}</view>
      </view>
      <view class="order-content">
        <view class="order-info">
          <text class="info-label">è®¢å•ç±»å‹ï¼š</text>
          <text>{{item.tableNo || 'å¤–å–'}}</text>
        </view>
        <view class="order-info address-row" wx:if="{{item.address}}">
          <text class="info-label">é…é€åœ°å€ï¼š</text>
          <text class="address-text">{{item.address.contact}} {{item.address.phone}} {{item.address.province}}{{item.address.city}}{{item.address.district}}{{item.address.detail}}</text>
        </view>
        <view class="order-info">
          <text class="info-label">é‡‘é¢ï¼š</text>
          <text class="order-amount">Â¥{{item.totalAmount}}</text>
        </view>
        <view class="order-info">
          <text class="info-label">ä¸‹å•æ—¶é—´ï¼š</text>
          <text>{{item.createdAtFormatted}}</text>
        </view>
        <view class="order-info" wx:if="{{item.remark}}">
          <text class="info-label">å¤‡æ³¨ï¼š</text>
          <text>{{item.remark}}</text>
        </view>
      </view>
      <view class="order-actions">
        <view 
          class="action-btn primary" 
          wx:if="{{item.status === 1 || (item.merchantUserId && item.merchantUserId === merchantUserId)}}"
          catchtap="{{item.status === 1 ? 'acceptOrder' : (item.status === 2 ? 'readyOrder' : (item.status === 3 ? 'startDelivery' : 'completeOrder'))}}"
          data-id="{{item.id}}"
        >{{item.status === 1 ? 'æ¥å•' : (item.status === 2 ? 'å‡ºé¤' : (item.status === 3 ? 'å¼€å§‹é…é€' : 'å®Œæˆ'))}}</view>
      </view>
    </view>
  </view>

  <view class="empty" wx:if="{{orders.length === 0}}">
    <text>æš‚æ— è®¢å•</text>
  </view>
</view>
